#!/bin/bash

# Use to update JMeter compatibility layer.
# Run in package root to produce file/jmeter-compat.js with latest versions.
# Commit the new bundle to save.

rm -rf build
mkdir -p build
cd build
echo '{"name":"-","version":"-"}' >package.json
npm install buffer he iconv-lite jsonpath papaparse perl-regex \
    @babel/runtime yaml
browserify -r buffer -r he -r iconv-lite:iconv -r jsonpath -r papaparse \
    -r perl-regex:perlRegex -r yaml > ../file/jmeter-compat.js
